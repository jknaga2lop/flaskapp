<!DOCTYPE html>
<html>
<head>
    <title>ToDo App</title>
</head>
<body>
    <form method="post">
        <select name="selected_user" onchange="this.form.submit()">
            {% for user in users %}
                <option value="{{ user.name }}" {% if user.name == selected_user %}selected{% endif %}>{{ user.name }}</option>
            {% endfor %}
        </select>
        <input type="text" name="new_user" placeholder="New Person's Name">
        <button type="submit" formaction="/add_user">Add Person</button>
    </form>
    <table>
        <tr>
            <th>Task No.</th>
            <th>Task Name</th>
            <th>Description</th>
            <th>Action</th>
        </tr>
        {% for task in tasks %}
            <tr>
                <td>{{ loop.index }}</td>
                <form method="post" action="/update/{{ task.id }}">
                    <td><input type="text" name="name" value="{{ task.name }}"></td>
                    <td><input type="text" name="description" value="{{ task.description }}"></td>
                    <td>
                        <button type="submit">Update</button>
                        <form method="post" action="/delete/{{ task.id }}">
                            <button type="submit">Delete</button>
                        </form>
                        <form method="post" action="/add/{{ selected_user }}">
                            <button type="submit">Add</button>
                        </form>
                    </td>
                </form>
            </tr>
        {% endfor %}
    </table>
</body>
</html>
